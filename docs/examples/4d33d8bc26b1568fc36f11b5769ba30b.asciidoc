// This file is autogenerated, DO NOT EDIT
// data-streams/failure-store-recipes.asciidoc:1152

[source, python]
----
resp = client.reindex(
    source={
        "index": "my-datastream-indexing-example::failures",
        "query": {
            "bool": {
                "must_not": [
                    {
                        "exists": {
                            "field": "error.pipeline"
                        }
                    }
                ],
                "must": [
                    {
                        "match": {
                            "document.index": "my-datastream-indexing-example"
                        }
                    },
                    {
                        "match": {
                            "error.type": "document_parsing_exception"
                        }
                    },
                    {
                        "range": {
                            "@timestamp": {
                                "gt": "2025-05-01T00:00:00Z",
                                "lte": "2025-05-28T19:00:00Z"
                            }
                        }
                    }
                ]
            }
        }
    },
    dest={
        "index": "my-datastream-indexing-example",
        "op_type": "create",
        "pipeline": "my-datastream-remediation-pipeline"
    },
)
print(resp)
----
