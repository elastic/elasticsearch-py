// This file is autogenerated, DO NOT EDIT
// esql/processing-commands/lookup.asciidoc:30

[source, python]
----
resp = client.esql.query(
    format="txt",
    query="\n      FROM library\n    | SORT page_count DESC\n    | KEEP name, author\n    | LOOKUP era ON author\n    | LIMIT 5\n  ",
    tables={
        "era": {
            "author": {
                "keyword": [
                    "Frank Herbert",
                    "Peter F. Hamilton",
                    "Vernor Vinge",
                    "Alastair Reynolds",
                    "James S.A. Corey"
                ]
            },
            "era": {
                "keyword": [
                    "The New Wave",
                    "Diamond",
                    "Diamond",
                    "Diamond",
                    "Hadron"
                ]
            }
        }
    },
)
print(resp)
----
