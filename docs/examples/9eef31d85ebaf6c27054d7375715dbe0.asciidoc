// This file is autogenerated, DO NOT EDIT
// watcher/actions.asciidoc:228

[source, python]
----
resp = client.watcher.put_watch(
    id="log_event_watch",
    trigger={
        "schedule": {
            "interval": "5m"
        }
    },
    input={
        "search": {
            "request": {
                "indices": "log-events",
                "body": {
                    "query": {
                        "match": {
                            "status": "error"
                        }
                    }
                }
            }
        }
    },
    condition={
        "compare": {
            "ctx.payload.hits.total": {
                "gt": 0
            }
        }
    },
    actions={
        "log_hits": {
            "foreach": "ctx.payload.hits.hits",
            "max_iterations": 500,
            "logging": {
                "text": "Found id {{ctx.payload._id}} with field {{ctx.payload._source.my_field}}"
            }
        }
    },
)
print(resp)
----
