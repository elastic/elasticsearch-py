// getting-started.asciidoc:691

[source, python]
----
resp = client.search(
    index="bank",
    body={
        "size": 0,
        "aggs": {
            "group_by_state": {
                "terms": {
                    "field": "state.keyword",
                    "order": {"average_balance": "desc"},
                },
                "aggs": {"average_balance": {"avg": {"field": "balance"}}},
            }
        },
    },
)
print(resp)
----