// This file is autogenerated, DO NOT EDIT
// aggregations/bucket/reverse-nested-aggregation.asciidoc:57

[source, python]
----
resp = client.search(
    index="issues",
    query={
        "match_all": {}
    },
    aggs={
        "comments": {
            "nested": {
                "path": "comments"
            },
            "aggs": {
                "top_usernames": {
                    "terms": {
                        "field": "comments.username"
                    },
                    "aggs": {
                        "comment_to_issue": {
                            "reverse_nested": {},
                            "aggs": {
                                "top_tags_per_comment": {
                                    "terms": {
                                        "field": "tags"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
)
print(resp)
----
